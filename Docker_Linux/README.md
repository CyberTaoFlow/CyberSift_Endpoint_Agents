# Docker Linux HIDS

This folder contains the **64-bit** executable for monitoring the Docker Host (currently Linux only supported), as well as a sample configuration file. 

## Installation
- Create a directory and download both the "DockerAgent" executable and the "config.json" file
- Ensure the DockerAgent has execute permissions (`chmod +x ./DockerAgent`)
- Edit config.json as appropriate:
    - Make sure the correct CyberSift IP address is configured for *"IPAddress"*
    - The *"Contain"* and *"DoNotContain"* arrays allow you to configure which docker images you would like to have monitored. Docker containers tend to be very verbose (hundreds of system calls a second) which may impact your performance. If your host is under performance pressure, it's a good idea to limit your monitoring to "high value" containers.
        - Note: the containers accept as input the IMAGE name, not the container name. In general, container names are randomly generated by docker (and manually specified docker names don't play well with orchestration tools)
        - Leaving the arrays empty will monitor all containers
        - The two arrays  can be used together
        - The keyword specified in the array can be present anywhere in the container image name, but regex is not supported
        
## Running
- Once configured, simply execute the DockerAgent file. This will output the raw system calls, for example:
`
citizenstig/dvwa:mmap:apache2:12565

citizenstig/dvwa:mmap:apache2:12565

citizenstig/dvwa:mprotect:apache2:12565
`

Generally there is no need to log these though in some environments this may be needed for forensic reasons. 

- For persistance, it's best to use a process control system like [supervisord](http://supervisord.org/)
